#  Integer Linear Programming Labeled Bayesian Networks

Consider an initial weighted graph  <img src="https://latex.codecogs.com/gif.image?\dpi{110}&space;\mathcal{G}&space;=&space;(V,E)" title="\mathcal{G} = (V,E)" />   and lists of labels l that are intended to encode the internal structure of <img src="https://latex.codecogs.com/gif.image?\dpi{110}&space;\mathcal{G}" title="\mathcal{G}" />. Each label <img src="https://latex.codecogs.com/gif.image?\dpi{110}&space;l(v_i)&space;\in&space;\mathbb{N}" title="l(v_i) \in \mathbb{N}" />, <img src="https://latex.codecogs.com/gif.image?\dpi{110}&space;i\in\{1,\cdots,n\}" title="i\in\{1,\cdots,n\}" />,  correspond to each node in V. With these elements it is possible to formulate a score-based learning problem as a linear integer optimisation problem, such that :


<img src="https://latex.codecogs.com/gif.image?\dpi{110}&space;\begin{align}&space;&space;&space;&space;&space;\max&space;\sum_{v,W}c(W,v)&space;\times&space;I(W&space;\rightarrow&space;v)&space;&&&space;&space;\nonumber\\&space;&space;&space;&space;\text{s.t.}&space;&&&space;&space;\nonumber\\&space;&space;&space;&space;\forall&space;v&space;\in&space;V:&space;\sum_{W}I(W&space;\rightarrow&space;v)=1&space;&&&space;\text{(exactly&space;one&space;incoming&space;edge&space;of&space;parent&space;set)}&space;\label{fully_connected}\\&space;&space;&space;\forall&space;\text{&space;edge}&space;=&space;(w,v)\in&space;E&space;\;&space;,&space;\forall&space;W&space;\subset&space;V&space;:&space;&space;&&&space;\text{(&space;acyclicity&space;constraint&space;)}&space;\nonumber&space;\\&space;&space;&space;l(w)&space;\geq&space;l(v)&space;&plus;&space;I(W&space;\rightarrow&space;v)&space;-&space;n(1-&space;I(W&space;\rightarrow&space;v))&space;\label{cycle_2}&space;&&&space;&space;\end{align}&space;" title="\begin{align} \max \sum_{v,W}c(W,v) \times I(W \rightarrow v) && \nonumber\\ \text{s.t.} && \nonumber\\ \forall v \in V: \sum_{W}I(W \rightarrow v)=1 && \text{(exactly one incoming edge of parent set)} \label{fully_connected}\\ \forall \text{ edge} = (w,v)\in E \; , \forall W \subset V : && \text{( acyclicity constraint )} \nonumber \\ l(w) \geq l(v) + I(W \rightarrow v) - n(1- I(W \rightarrow v)) \label{cycle_2} && \end{align} " />
